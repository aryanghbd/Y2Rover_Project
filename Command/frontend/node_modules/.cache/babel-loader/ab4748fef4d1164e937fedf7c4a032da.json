{"ast":null,"code":"var _jsxFileName = \"/Users/hollysolomon/Documents/year2/finalproject/test2/react-crud/src/components/mapv2.component.js\";\nimport { CanvasJSChart } from 'canvasjs-react-charts';\nimport React, { Component } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar data = [];\nvar pos = [''];\nvar updateInterval = 10;\nvar lastMsg;\nvar lastTopic;\nvar colour = '';\nvar objectproximity = '';\nvar objectcoordinates = '';\n\nvar mqtt = require('mqtt');\n\nvar client = mqtt.connect(\"ws://18.117.97.5:9001\", {\n  clientId: \"react_position\",\n  username: \"hs2119\",\n  password: \"marsrover\"\n});\nconsole.log(\"connected flag  \" + client.connected);\nvar topic_list = [\"position\", \"colour\", \"objectproximity\", \"objectcoordinates\"];\nconsole.log(\"subscribing to topics\");\nclient.subscribe(topic_list, {\n  qos: 1\n}); //topic list\n\nclient.on(\"connect\", function () {\n  console.log(\"connected  \" + client.connected);\n});\n\nclass Map extends Component {\n  constructor() {\n    super();\n    this.updateChart = this.updateChart.bind(this);\n    this.updateColour = this.updateColour.bind(this);\n    this.updateProximity = this.updateProximity.bind(this);\n    this.updateCoordinates = this.updateCoordinates.bind(this);\n  }\n\n  componentDidMount() {\n    setInterval(this.updateChart, updateInterval); //\tthis.updateColour();\n    //\tthis.updateProximity();\n    //\tthis.updateCoordinates();\n  }\n\n  updateChart() {\n    client.on('message', function (topic, message, packet) {\n      console.log(\"message is \" + message);\n      console.log(\"topic is \" + topic);\n      lastMsg = message.toString();\n      lastTopic = topic.toString();\n      console.log(lastTopic);\n    });\n    console.log(lastTopic);\n\n    if (lastTopic == 'colour') {\n      colour = lastMsg;\n      console.log(colour); //this.chart.render(colour,objectproximity,objectcoordinates);\n    }\n\n    if (lastTopic == 'objectproximity') {\n      objectproximity = lastMsg;\n      this.chart.render(colour, objectproximity, objectcoordinates);\n    }\n\n    if (lastTopic == 'objectcoordinates') {\n      objectcoordinates = lastMsg;\n      this.chart.render(colour, objectproximity, objectcoordinates);\n    }\n\n    if (lastTopic == 'position') {\n      if (lastMsg != null && lastMsg != pos[pos.length - 1] && this.chart != null) {\n        pos.push(lastMsg);\n        console.log(\"diff value\" + lastMsg + \" \" + pos[pos.length - 1]);\n        var coords_str = lastMsg.split(',');\n        var x = parseFloat(coords_str[0]);\n        var y = parseFloat(coords_str[1]);\n        data.push({\n          x: x,\n          y: y\n        });\n        console.log(data);\n        console.log(this.chart);\n        this.chart.render(colour, objectproximity, objectcoordinates);\n      }\n    }\n  }\n\n  updateColour() {\n    client.on('message', function (topic, message, packet) {\n      console.log(\"message is \" + message);\n      console.log(\"topic is \" + topic);\n      console.log(\"im here\");\n      console.log(message.toString());\n      lastMsg = message.toString();\n      lastTopic = topic.toString();\n    });\n\n    if (lastTopic == 'colour') {\n      console.log('im here');\n      return lastMsg;\n    }\n  }\n\n  updateProximity() {\n    client.on('message', function (topic, message, packet) {\n      console.log(\"message is \" + message);\n      console.log(\"topic is \" + topic);\n      lastMsg = message.toString();\n      lastTopic = topic.toString();\n      console.log(lastMsg);\n    });\n\n    if (lastTopic == 'objectproximity') {\n      return lastMsg;\n    }\n  }\n\n  updateCoordinates() {\n    client.on('message', function (topic, message, packet) {\n      console.log(\"message is \" + message);\n      console.log(\"topic is \" + topic);\n      lastMsg = message.toString();\n      lastTopic = topic.toString();\n    });\n\n    if (lastTopic == 'objectcoordinates') {\n      return lastMsg;\n    }\n  }\n\n  render(colour, objectproximity, objectcoordinates) {\n    const options = {\n      title: {\n        text: \"Mars Rover Plot\"\n      },\n      data: [{\n        type: \"line\",\n        dataPoints: data\n      }]\n    };\n    console.log('im here');\n    console.log(this.updateChart());\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(CanvasJSChart, {\n        options: options,\n        onRef: ref => this.chart = ref\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 4\n      }, this), \"$\", this.updateColour(), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"An object coloured $\", \" has been detected with position \", \", the object is \", \" \"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 4\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 3\n    }, this);\n  }\n\n}\n\nexport default Map;","map":{"version":3,"sources":["/Users/hollysolomon/Documents/year2/finalproject/test2/react-crud/src/components/mapv2.component.js"],"names":["CanvasJSChart","React","Component","data","pos","updateInterval","lastMsg","lastTopic","colour","objectproximity","objectcoordinates","mqtt","require","client","connect","clientId","username","password","console","log","connected","topic_list","subscribe","qos","on","Map","constructor","updateChart","bind","updateColour","updateProximity","updateCoordinates","componentDidMount","setInterval","topic","message","packet","toString","chart","render","length","push","coords_str","split","x","parseFloat","y","options","title","text","type","dataPoints","ref"],"mappings":";AAAA,SAAQA,aAAR,QAA4B,uBAA5B;AACA,OAAOC,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;;AAEA,IAAIC,IAAI,GAAG,EAAX;AACA,IAAIC,GAAG,GAAG,CAAC,EAAD,CAAV;AACA,IAAIC,cAAc,GAAG,EAArB;AAEA,IAAIC,OAAJ;AACA,IAAIC,SAAJ;AACA,IAAIC,MAAM,GAAG,EAAb;AACA,IAAIC,eAAe,GAAG,EAAtB;AACA,IAAIC,iBAAiB,GAAG,EAAxB;;AACA,IAAIC,IAAI,GAAGC,OAAO,CAAC,MAAD,CAAlB;;AACA,IAAIC,MAAM,GAAGF,IAAI,CAACG,OAAL,CAAa,uBAAb,EAAsC;AAACC,EAAAA,QAAQ,EAAC,gBAAV;AAA4BC,EAAAA,QAAQ,EAAC,QAArC;AAA+CC,EAAAA,QAAQ,EAAC;AAAxD,CAAtC,CAAb;AACAC,OAAO,CAACC,GAAR,CAAY,qBAAqBN,MAAM,CAACO,SAAxC;AAEA,IAAIC,UAAU,GAAC,CAAC,UAAD,EAAY,QAAZ,EAAsB,iBAAtB,EAAyC,mBAAzC,CAAf;AACAH,OAAO,CAACC,GAAR,CAAY,uBAAZ;AACAN,MAAM,CAACS,SAAP,CAAiBD,UAAjB,EAA4B;AAACE,EAAAA,GAAG,EAAC;AAAL,CAA5B,E,CAAsC;;AAEtCV,MAAM,CAACW,EAAP,CAAU,SAAV,EAAoB,YAAU;AAC5BN,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAeN,MAAM,CAACO,SAAlC;AACC,CAFH;;AAKA,MAAMK,GAAN,SAAkBvB,SAAlB,CAA4B;AAC3BwB,EAAAA,WAAW,GAAG;AACb;AACA,SAAKC,WAAL,GAAmB,KAAKA,WAAL,CAAiBC,IAAjB,CAAsB,IAAtB,CAAnB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACA,SAAKE,eAAL,GAAuB,KAAKA,eAAL,CAAqBF,IAArB,CAA0B,IAA1B,CAAvB;AACA,SAAKG,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBH,IAAvB,CAA4B,IAA5B,CAAzB;AACA;;AACDI,EAAAA,iBAAiB,GAAG;AACnBC,IAAAA,WAAW,CAAC,KAAKN,WAAN,EAAmBtB,cAAnB,CAAX,CADmB,CAEpB;AACA;AACA;AACC;;AAEDsB,EAAAA,WAAW,GAAG;AACbd,IAAAA,MAAM,CAACW,EAAP,CAAU,SAAV,EAAoB,UAASU,KAAT,EAAgBC,OAAhB,EAAyBC,MAAzB,EAAgC;AAChDlB,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAegB,OAA3B;AACAjB,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAae,KAAzB;AACA5B,MAAAA,OAAO,GAAG6B,OAAO,CAACE,QAAR,EAAV;AACH9B,MAAAA,SAAS,GAAG2B,KAAK,CAACG,QAAN,EAAZ;AACAnB,MAAAA,OAAO,CAACC,GAAR,CAAYZ,SAAZ;AACE,KANH;AAODW,IAAAA,OAAO,CAACC,GAAR,CAAYZ,SAAZ;;AACG,QAAIA,SAAS,IAAI,QAAjB,EAA0B;AAC5BC,MAAAA,MAAM,GAAGF,OAAT;AACAY,MAAAA,OAAO,CAACC,GAAR,CAAYX,MAAZ,EAF4B,CAG5B;AACE;;AACD,QAAID,SAAS,IAAI,iBAAjB,EAAmC;AACpCE,MAAAA,eAAe,GAAGH,OAAlB;AACA,WAAKgC,KAAL,CAAWC,MAAX,CAAkB/B,MAAlB,EAAyBC,eAAzB,EAAyCC,iBAAzC;AACE;;AACD,QAAIH,SAAS,IAAI,mBAAjB,EAAqC;AACtCG,MAAAA,iBAAiB,GAAGJ,OAApB;AACA,WAAKgC,KAAL,CAAWC,MAAX,CAAkB/B,MAAlB,EAAyBC,eAAzB,EAAyCC,iBAAzC;AACC;;AACF,QAAIH,SAAS,IAAI,UAAjB,EAA4B;AACxB,UAAID,OAAO,IAAI,IAAX,IAAmBA,OAAO,IAAIF,GAAG,CAACA,GAAG,CAACoC,MAAJ,GAAa,CAAd,CAAjC,IAAqD,KAAKF,KAAL,IAAc,IAAvE,EAA6E;AAC5ElC,QAAAA,GAAG,CAACqC,IAAJ,CAASnC,OAAT;AACEY,QAAAA,OAAO,CAACC,GAAR,CAAY,eAAcb,OAAd,GAAwB,GAAxB,GAA8BF,GAAG,CAACA,GAAG,CAACoC,MAAJ,GAAa,CAAd,CAA7C;AAEA,YAAIE,UAAU,GAAGpC,OAAO,CAACqC,KAAR,CAAc,GAAd,CAAjB;AACA,YAAIC,CAAC,GAAGC,UAAU,CAACH,UAAU,CAAC,CAAD,CAAX,CAAlB;AACA,YAAII,CAAC,GAAGD,UAAU,CAACH,UAAU,CAAC,CAAD,CAAX,CAAlB;AACAvC,QAAAA,IAAI,CAACsC,IAAL,CAAU;AAACG,UAAAA,CAAC,EAAEA,CAAJ;AAAME,UAAAA,CAAC,EAAEA;AAAT,SAAV;AACA5B,QAAAA,OAAO,CAACC,GAAR,CAAYhB,IAAZ;AACHe,QAAAA,OAAO,CAACC,GAAR,CAAY,KAAKmB,KAAjB;AACG,aAAKA,KAAL,CAAWC,MAAX,CAAkB/B,MAAlB,EAAyBC,eAAzB,EAAyCC,iBAAzC;AACH;AAAE;AAIL;;AAEDmB,EAAAA,YAAY,GAAG;AACdhB,IAAAA,MAAM,CAACW,EAAP,CAAU,SAAV,EAAoB,UAASU,KAAT,EAAgBC,OAAhB,EAAyBC,MAAzB,EAAgC;AACnDlB,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAegB,OAA3B;AACAjB,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAae,KAAzB;AACAhB,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAD,MAAAA,OAAO,CAACC,GAAR,CAAYgB,OAAO,CAACE,QAAR,EAAZ;AACA/B,MAAAA,OAAO,GAAG6B,OAAO,CAACE,QAAR,EAAV;AACA9B,MAAAA,SAAS,GAAG2B,KAAK,CAACG,QAAN,EAAZ;AAEE,KARH;;AAUE,QAAI9B,SAAS,IAAI,QAAjB,EAA0B;AACzBW,MAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACF,aAAOb,OAAP;AACE;AACH;;AAGDwB,EAAAA,eAAe,GAAG;AACjBjB,IAAAA,MAAM,CAACW,EAAP,CAAU,SAAV,EAAoB,UAASU,KAAT,EAAgBC,OAAhB,EAAyBC,MAAzB,EAAgC;AACnDlB,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAegB,OAA3B;AACAjB,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAae,KAAzB;AACA5B,MAAAA,OAAO,GAAG6B,OAAO,CAACE,QAAR,EAAV;AACA9B,MAAAA,SAAS,GAAG2B,KAAK,CAACG,QAAN,EAAZ;AACAnB,MAAAA,OAAO,CAACC,GAAR,CAAYb,OAAZ;AACE,KANH;;AAQE,QAAIC,SAAS,IAAI,iBAAjB,EAAmC;AACpC,aAAOD,OAAP;AACE;AACH;;AAEDyB,EAAAA,iBAAiB,GAAG;AACnBlB,IAAAA,MAAM,CAACW,EAAP,CAAU,SAAV,EAAoB,UAASU,KAAT,EAAgBC,OAAhB,EAAyBC,MAAzB,EAAgC;AACnDlB,MAAAA,OAAO,CAACC,GAAR,CAAY,gBAAegB,OAA3B;AACAjB,MAAAA,OAAO,CAACC,GAAR,CAAY,cAAae,KAAzB;AACA5B,MAAAA,OAAO,GAAG6B,OAAO,CAACE,QAAR,EAAV;AACA9B,MAAAA,SAAS,GAAG2B,KAAK,CAACG,QAAN,EAAZ;AACE,KALH;;AAOE,QAAI9B,SAAS,IAAI,mBAAjB,EAAqC;AACtC,aAAOD,OAAP;AACE;AACH;;AAEDiC,EAAAA,MAAM,CAAC/B,MAAD,EAAQC,eAAR,EAAwBC,iBAAxB,EAA2C;AAChD,UAAMqC,OAAO,GAAG;AACfC,MAAAA,KAAK,EAAE;AACNC,QAAAA,IAAI,EAAE;AADA,OADQ;AAIf9C,MAAAA,IAAI,EAAE,CAAC;AACN+C,QAAAA,IAAI,EAAE,MADA;AAENC,QAAAA,UAAU,EAAGhD;AAFP,OAAD;AAJS,KAAhB;AASAe,IAAAA,OAAO,CAACC,GAAR,CAAY,SAAZ;AACAD,IAAAA,OAAO,CAACC,GAAR,CAAY,KAAKQ,WAAL,EAAZ;AACA,wBACA;AAAA,8BACC,QAAC,aAAD;AAAe,QAAA,OAAO,EAAIoB,OAA1B;AACE,QAAA,KAAK,EAAEK,GAAG,IAAI,KAAKd,KAAL,GAAac;AAD7B;AAAA;AAAA;AAAA;AAAA,cADD,OAIG,KAAKvB,YAAL,EAJH,eAMC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAND;AAAA;AAAA;AAAA;AAAA;AAAA,YADA;AAUA;;AA1H0B;;AA4H5B,eAAeJ,GAAf","sourcesContent":["import {CanvasJSChart} from 'canvasjs-react-charts'\nimport React, { Component } from 'react';\n\nvar data = []\nvar pos = ['']\nvar updateInterval = 10;\n\nvar lastMsg\nvar lastTopic\nvar colour = ''\nvar objectproximity = ''\nvar objectcoordinates = ''\nvar mqtt = require('mqtt')\nvar client = mqtt.connect(\"ws://18.117.97.5:9001\", {clientId:\"react_position\", username:\"hs2119\", password:\"marsrover\"})\nconsole.log(\"connected flag  \" + client.connected);\n\nvar topic_list=[\"position\",\"colour\", \"objectproximity\", \"objectcoordinates\"];\nconsole.log(\"subscribing to topics\");\nclient.subscribe(topic_list,{qos:1}); //topic list\n\nclient.on(\"connect\",function(){\t\n  console.log(\"connected  \"+ client.connected);\n  })\n\n\nclass Map extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.updateChart = this.updateChart.bind(this);\n\t\tthis.updateColour = this.updateColour.bind(this);\n\t\tthis.updateProximity = this.updateProximity.bind(this);\n\t\tthis.updateCoordinates = this.updateCoordinates.bind(this);\n\t}\n\tcomponentDidMount() {\n\t\tsetInterval(this.updateChart, updateInterval);\n\t//\tthis.updateColour();\n\t//\tthis.updateProximity();\n\t//\tthis.updateCoordinates();\n\t}\n\n\tupdateChart() {\n\t\tclient.on('message',function(topic, message, packet){\n      console.log(\"message is \"+ message);\n      console.log(\"topic is \"+ topic);\n      lastMsg = message.toString()\n\t  lastTopic = topic.toString()\n\t  console.log(lastTopic)\n    })\n\tconsole.log(lastTopic)\n    if (lastTopic == 'colour'){\n\t\tcolour = lastMsg\n\t\tconsole.log(colour)\n\t\t//this.chart.render(colour,objectproximity,objectcoordinates);\n\t  }\n\t  if (lastTopic == 'objectproximity'){\n\t\tobjectproximity = lastMsg\n\t\tthis.chart.render(colour,objectproximity,objectcoordinates);\n\t  }\n\t  if (lastTopic == 'objectcoordinates'){\n\t\tobjectcoordinates = lastMsg\n\t\tthis.chart.render(colour,objectproximity,objectcoordinates);\n  }\n\tif (lastTopic == 'position'){\n    \tif (lastMsg != null && lastMsg != pos[pos.length - 1] && this.chart != null ){\n    \t\tpos.push(lastMsg)\n      \t\tconsole.log(\"diff value\"+ lastMsg + \" \" + pos[pos.length - 1])\n      \n      \t\tvar coords_str = lastMsg.split(',')\n      \t\tvar x = parseFloat(coords_str[0]);\n      \t\tvar y = parseFloat(coords_str[1]);\n      \t\tdata.push({x: x,y: y});\n      \t\tconsole.log(data)\n\t\t\t  console.log(this.chart)\n      \t\tthis.chart.render(colour,objectproximity,objectcoordinates);\n    } }\n\t\n\t\n\t\t\n\t}\n\n\tupdateColour() {\n\t\tclient.on('message',function(topic, message, packet){\n\t\t\tconsole.log(\"message is \"+ message);\n\t\t\tconsole.log(\"topic is \"+ topic);\n\t\t\tconsole.log(\"im here\")\n\t\t\tconsole.log(message.toString())\n\t\t\tlastMsg = message.toString()\n\t\t\tlastTopic = topic.toString()\n\t\t\t\n\t\t  })\n\t\t  \n\t\t  if (lastTopic == 'colour'){\n\t\t\t  console.log('im here')\n\t\t\treturn lastMsg\n\t\t  }\n\t}\n\n\n\tupdateProximity() {\n\t\tclient.on('message',function(topic, message, packet){\n\t\t\tconsole.log(\"message is \"+ message);\n\t\t\tconsole.log(\"topic is \"+ topic);\n\t\t\tlastMsg = message.toString()\n\t\t\tlastTopic = topic.toString()\n\t\t\tconsole.log(lastMsg)\n\t\t  })\n\t\t  \n\t\t  if (lastTopic == 'objectproximity'){\n\t\t\treturn lastMsg\n\t\t  }\n\t}\n\n\tupdateCoordinates() {\n\t\tclient.on('message',function(topic, message, packet){\n\t\t\tconsole.log(\"message is \"+ message);\n\t\t\tconsole.log(\"topic is \"+ topic);\n\t\t\tlastMsg = message.toString()\n\t\t\tlastTopic = topic.toString()\n\t\t  })\n\t\t  \n\t\t  if (lastTopic == 'objectcoordinates'){\n\t\t\treturn lastMsg\n\t\t  }\n\t}\n\n\trender(colour,objectproximity,objectcoordinates) {\n\t\tconst options = {\n\t\t\ttitle :{\n\t\t\t\ttext: \"Mars Rover Plot\"\n\t\t\t},\n\t\t\tdata: [{\n\t\t\t\ttype: \"line\",\n\t\t\t\tdataPoints : data\n\t\t\t}]\n\t\t}\n\t\tconsole.log('im here')\n\t\tconsole.log(this.updateChart())\n\t\treturn (\n\t\t<div>\n\t\t\t<CanvasJSChart options = {options}\n\t\t\t\t onRef={ref => this.chart = ref}\n\t\t\t/>\n\t\t\t${this.updateColour()}\n\t\t\t{/*You can get reference to the chart instance as shown above using onRef. This allows you to access all chart properties and methods*/}\n\t\t\t<h4>An object coloured ${} has been detected with position {}, the object is {} </h4>\n\t\t</div>\n\t\t);\n\t}\n}\nexport default Map;                     "]},"metadata":{},"sourceType":"module"}